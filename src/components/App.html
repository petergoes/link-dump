<PageHeader />
<Search ref:search />
<main>
	<GroupCollection :editing />
	<aside class="actions">
		{{#if editing}}
		<button on:click="showAddLinkModal()">Add link</button>
		<button on:click="showAddCollectionModal()">Add collection</button>
		{{/if}}
		<button on:click="set({ editing: !editing })">Edit</button>
	</aside>
</main>
<PageFooter />
<AddCollection ref:addCollection/>
<AddLink ref:addLink/>

<style>
	@import 'reset.css';
	@import 'global-styles.css';
	@import 'body-layout.css';

	.actions > :last-child {
		float: right;
	}
</style>

<script>
	import AddCollection from './AddCollection.html';
	import AddLink from './AddLink.html';
	import GroupCollection from './GroupCollection.html';
	import PageFooter from './PageFooter.html';
	import PageHeader from './PageHeader.html';
	import Search from './Search.html';
	import store from '../store';

	export default {
		store: () => store,
		oncreate() {
			window.addEventListener('keydown', event => {
				// keyCode = a
				if(event.keyCode === 65 && event.metaKey) {
					this.refs.addLink.show()
				}

				// keyCode = d
				if(event.keyCode === 68 && event.metaKey) {
					this.refs.addCollection.show()
				}

				// keycode = e
				if(event.keyCode === 69 && event.metaKey) {
					this.set({ editing: !this.get('editing') });
				}

				// keycode = f
				if(event.keyCode === 70 && event.metaKey && event.shiftKey) {
					this.refs.search.refs.inputSearch.focus();
				}

				// keyCode = esc
				if(event.keyCode === 27 && (event.target.type === 'search' || event.target.classList.contains('search-list-link'))) {
					this.refs.search.refs.inputSearch.select();
				}
			});
		},
		data() {
			return {
				editing: false
			}
		},
		components: {
			AddCollection,
			AddLink,
			GroupCollection,
			PageFooter,
			PageHeader,
			Search,
		},
		methods: {
			showAddLinkModal() {
				this.refs.addLink.show();
			},
			showAddCollectionModal() {
				this.refs.addCollection.show();
			}
		}
	}
</script>
